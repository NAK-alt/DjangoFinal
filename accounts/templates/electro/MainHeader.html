{% load static %}

<div id="header">
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="header-logo">
                    <a href="{% url 'index' %}" class="logo">
                        <img src="{% static 'img/logo.png' %}" alt="Logo">
                    </a>
                </div>
            </div>

            <div class="col-md-6">
                <div class="header-search">
                    <form method="GET" action="{% url 'All' %}">
                        <select name="category" class="input-select">
                            <option value="">All Categories</option>
                            {% for category in ObjDTCategory %}
                                <option value="{{ category.id }}"
                                    {% if request.GET.category == category.id|stringformat:'s' %} selected {% endif %}
                                >
                                    {{ category.categoryName }}
                                </option>
                            {% endfor %}
                        </select>
                        <input class="input" type="text" name="q" placeholder="Search here" value="{{ request.GET.q }}">
                        <button type="submit" class="search-btn">Search</button>
                    </form>
                </div>
            </div>

            <div class="col-md-3 clearfix">
                <div class="header-ctn">
                    <div>
                        <a href="javascript:void(0)" id="team-open">
                            <i class="fa fa-users" aria-hidden="true"></i>
                            <span>Our Team</span>
                            <div class="qty">5</div>
                        </a>
                    </div>

                    <div class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true" style="cursor: pointer;">
                            <i class="fa fa-shopping-cart"></i>
                            <span>Your Cart</span>
                            <div class="qty">{{ cart_count|default:0 }}</div> 
                        </a>
                        <div class="cart-dropdown">
                            <div class="cart-list">
                                {% if cart %}
                                    {% for id, item in cart.items %} 
                                        <div class="product-widget">
                                            <div class="product-img">
                                                <img src="{% static item.image %}" alt="{{ item.productName }}"> 
                                            </div>
                                            <div class="product-body">
                                                <h3 class="product-name"><a href="{% url 'productDetail' id %}">{{ item.productName }}</a></h3>
                                                <h4 class="product-price">{{ item.quantity }}x ${{ item.price|floatformat:2 }}</h4>
                                            </div>
                                            <a href="{% url 'remove_from_cart' id %}" class="delete"><i class="fa fa-close"></i></a>
                                        </div>
                                    {% endfor %}
                                {% else %}
                                    <p style="padding: 10px; text-align: center; color: #333;">No products in cart</p>
                                {% endif %}
                            </div>
                            <div class="cart-summary">
                                <small>{{ cart_count|default:0 }} Item(s) selected</small>
                                <h5>SUBTOTAL: ${{ cart_total|default:"0.00" }}</h5>
                            </div>
                            <div class="cart-btns">
                                <a href="{% url 'view_cart' %}">View Cart</a>
                                <a href="{% url 'checkout_view' %}">Checkout <i class="fa fa-arrow-circle-right"></i></a>
                            </div>
                        </div>
                    </div>

                    <div class="menu-toggle">
                        <a href="#"><i class="fa fa-bars"></i><span>Menu</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="team-modal" class="team-modal-overlay">
    <div class="team-modal-content">
        <span class="close-modal">&times;</span>
        <h2 class="modal-title">Our Team</h2>
        <div class="team-grid">
            <div class="member-card">
                <img src="{% static 'img/profile.jpg' %}" alt="Sophin Sakvady">
                <div class="member-info"><strong>Sophin Sakvady</strong></div>
            </div>
            <div class="member-card">
                <img src="{% static 'img/profile.jpg' %}" alt="Phal Vong Vathanak">
                <div class="member-info"><strong>Phal Vong Vathanak</strong></div>
            </div>
            <div class="member-card">
                <img src="{% static 'img/profile.jpg' %}" alt="Auk Socheanita">
                <div class="member-info"><strong>Auk Socheanita</strong></div>
            </div>
            <div class="member-card">
                <img src="{% static 'img/profile.jpg' %}" alt="Mok Pichnary">
                <div class="member-info"><strong>Mok Pichnary</strong></div>
            </div>
            <div class="member-card">
                <img src="{% static 'img/profile.jpg' %}" alt="Chhorn Chinghong">
                <div class="member-info"><strong>Chhorn Chinghong</strong></div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Smooth Transition Overlay */
    .team-modal-overlay {
        position: fixed;
        z-index: 99999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        
        /* Initial Hidden State */
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Active State for Overlay */
    .team-modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    /* Smooth Pop-up Content Box */
    .team-modal-content {
        background: #ffffff;
        width: 90%;
        max-width: 650px;
        position: absolute;
        top: 50%;
        left: 50%;
        padding: 40px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        
        /* Transform for Pop effect */
        transform: translate(-50%, -45%) scale(0.9);
        transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* Final Position when Active */
    .team-modal-overlay.active .team-modal-content {
        transform: translate(-50%, -50%) scale(1);
    }

    .modal-title { color: #333; margin-bottom: 30px; font-weight: 800; font-size: 24px; }

    .team-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
    }

    .member-card { 
        width: 140px; 
        transition: transform 0.3s ease; 
    }

    .member-card:hover { transform: translateY(-10px); }

    .member-card img {
        width: 85px;
        height: 85px;
        border-radius: 50%;
        margin-bottom: 15px;
        border: 3px solid #D10024;
        object-fit: cover;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .member-info strong { display: block; color: #333; font-size: 14px; margin-bottom: 2px; }
    .member-info span { color: #888; font-size: 12px; }

    .close-modal {
        position: absolute;
        top: 20px;
        right: 25px;
        font-size: 32px;
        cursor: pointer;
        color: #bbb;
        transition: color 0.2s;
    }
    .close-modal:hover { color: #D10024; }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById("team-modal");
        const openBtn = document.getElementById("team-open");
        const closeBtn = document.querySelector(".close-modal");

        // Open with Smooth Transition
        openBtn.onclick = function(e) {
            e.preventDefault();
            modal.classList.add("active");
            document.body.style.overflow = "hidden"; // Prevent page scroll
        };

        // Close function
        function hideTeamModal() {
            modal.classList.remove("active");
            document.body.style.overflow = "auto"; // Re-enable scroll
        }

        closeBtn.onclick = hideTeamModal;

        // Close if clicking outside the box
        window.onclick = function(event) {
            if (event.target == modal) {
                hideTeamModal();
            }
        };

        // Close on Escape Key
        document.addEventListener('keydown', function(e) {
            if (e.key === "Escape") hideTeamModal();
        });
    });
</script>